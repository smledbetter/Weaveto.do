# M8 — Vulnerability Scanning: Acceptance Criteria

## Release Goal
All critical and high severity vulnerabilities across shipped milestones (M0-M7) are identified, documented, and fixed. A security report is produced with findings rated by severity.

## Must-Have Outcomes

### 1. Security Report
- Comprehensive vulnerability report covering all 5 audit areas
- Each finding rated: critical / high / medium / low / info
- Each finding includes: file, line numbers, description, whether code fix needed
- Report committed as `docs/milestones/M8-vulnerability-scanning/SECURITY-REPORT.md`

### 2. All Critical Findings Fixed
- **Relay: No rate limiting** — connection + message rate limits added
- **Relay: No connection/room limits** — bounded room count, clients per room, connections per IP

### 3. All High Findings Fixed
- **Relay: Purge uses self-reported identity** — verify against connection's registered identity
- **Relay: No sender identity verification** — validate senderIdentityKey matches connection
- **Relay: key_share skips membership check** — verify sender is room member
- **Relay: No origin validation** — add Origin header checking on upgrade
- **Agent: Signature verification optional by default** — enforce for user-uploaded modules
- **Client: console.log/console.error in reminders.ts** — remove per security policy

### 4. Medium Findings Triaged
- Each medium finding either fixed or documented with rationale for deferral
- Agent event validation bypass chain addressed (host helpers skip validateEmittedEvent)
- console.warn violations in runtime.ts removed
- Notification body plaintext leak fixed (use generic message)
- prfSeed not cleared on disconnect — fixed

### 5. Existing Tests Still Pass
- `npm run test:unit` — 389+ tests, 0 regressions
- `npm run check` — TypeScript clean
- `npm run build` — production build succeeds

## Out of Scope (Deferred)
- JavaScript GC memory zeroing limitations (no practical fix)
- Server-side WebAuthn challenge verification (no server by design)
- PRF static salt (WebAuthn spec mandates per-credential isolation)
- Full TLS configuration audit (deployment-specific, not app code)
